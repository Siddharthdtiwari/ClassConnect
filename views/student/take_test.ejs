<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Class Tests</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }

      .bg-brand-background {
        background-color: #f3f4f6;
        background-image: linear-gradient(120deg, #f3e8ff 0%, #eef2f3 100%);
      }

      .text-brand-purple {
        color: #5d3a9b;
      }

      .border-brand-purple {
        border-color: #5d3a9b;
      }

      .btn-outline-purple {
        color: #5d3a9b;
        border: 1px solid #5d3a9b;
        font-weight: 600;
        transition: background-color 0.3s ease, color 0.3s ease,
          border-color 0.3s ease;
        border-radius: 0.5rem;
      }

      .btn-outline-purple:hover,
      .btn-outline-purple.active {
        background-color: #bde045;
        color: #333;
        border-color: #bde045;
      }

      .btn-lime {
        background-color: #bde045;
        color: #333;
        font-weight: 700;
        transition: background-color 0.3s ease;
        border-radius: 0.5rem;
      }

      .btn-lime:hover {
        background-color: #a8c93a;
      }

      .btn-lime:disabled {
        background-color: #e5e7eb;
        color: #9ca3af;
        cursor: not-allowed;
      }

      .test-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.07);
      }
    </style>
  </head>
  <%- include('../partials/background') %>

  <body class="text-gray-800">
    <div
      class="content-container container mx-auto p-4 sm:p-6 lg:p-8 min-h-screen"
    >
      <header class="mb-8">
        <a
          href="/student/dashboard"
          class="text-sm text-brand-purple hover:underline mb-2 block"
          >&larr; Back to Dashboard</a
        >
        <h1 class="text-3xl md:text-4xl font-bold text-gray-900">
          Upcoming Tests
        </h1>
        <p class="text-gray-600 mt-1">
          Download your test papers for Class <%= studentStandard %>.
        </p>
      </header>

      <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
        <div class="mb-8">
          <h2 class="text-2xl font-bold text-gray-900 mb-4">Subjects</h2>
          <div id="subject-tabs" class="flex flex-wrap gap-4">
            <a
              href="/student/take_test?subject=overall"
              class="px-6 py-2 btn-outline-purple <%= subject === 'overall' ? 'active' : '' %>"
            >
              Overall
            </a>
            <a
              href="/student/take_test?subject=English"
              class="px-6 py-2 btn-outline-purple <%= subject === 'English' ? 'active' : '' %>"
            >
              English
            </a>
            <a
              href="/student/take_test?subject=Maths I"
              class="px-6 py-2 btn-outline-purple <%= subject === 'Maths I' ? 'active' : '' %>"
            >
              Maths I
            </a>
            <a
              href="/student/take_test?subject=Maths II"
              class="px-6 py-2 btn-outline-purple <%= subject === 'Maths II' ? 'active' : '' %>"
            >
              Maths II
            </a>
            <a
              href="/student/take_test?subject=Science I"
              class="px-6 py-2 btn-outline-purple <%= subject === 'Science I' ? 'active' : '' %>"
            >
              Science I
            </a>
            <a
              href="/student/take_test?subject=Science II"
              class="px-6 py-2 btn-outline-purple <%= subject === 'Science II' ? 'active' : '' %>"
            >
              Science II
            </a>
            <a
              href="/student/take_test?subject=History-Civics"
              class="px-6 py-2 btn-outline-purple <%= subject === 'History-Civics' ? 'active' : '' %>"
            >
              History-Civics
            </a>
            <a
              href="/student/take_test?subject=Geography"
              class="px-6 py-2 btn-outline-purple <%= subject === 'Geography' ? 'active' : '' %>"
            >
              Geography
            </a>
            <a
              href="/student/take_test?subject=Hindi"
              class="px-6 py-2 btn-outline-purple <%= subject === 'Hindi' ? 'active' : '' %>"
            >
              Hindi
            </a>
            <a
              href="/student/take_test?subject=Marathi"
              class="px-6 py-2 btn-outline-purple <%= subject === 'Marathi' ? 'active' : '' %>"
            >
              Marathi
            </a>
          </div>
        </div>

        <div id="tests-area">
          <% if (tests.length===0) { %>
          <div class="text-center py-12">
            <svg
              class="mx-auto h-12 w-12 text-gray-400"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
              />
            </svg>
            <h3 class="mt-2 text-sm font-medium text-gray-900">
              No Tests Found
            </h3>
            <p class="mt-1 text-sm text-gray-500">
              No tests available for <%= subject==='overall' ? ('Class ' +
              studentStandard) : subject %>.
            </p>
          </div>
          <% } else { %>
          <div class="space-y-4">
            <% tests.forEach(test => { %>
            <div
              class="test-card bg-white p-6 rounded-lg border border-gray-200 flex flex-col md:flex-row items-start md:items-center justify-between gap-4"
            >
              <div class="flex-grow">
                <h4 class="text-lg font-bold text-gray-800">
                  <%= test.testName %>
                </h4>
                <div
                  class="flex flex-wrap gap-x-4 gap-y-1 text-sm text-gray-500 mt-2"
                >
                  <span>Subject: <%= test.subject %></span>
                  <span class="hidden md:inline">|</span>
                  <span>Topic: <%= test.topic || ' N/A' %></span>
                  <span class="hidden md:inline">|</span>
                  <span>Total Marks: <%= test.totalMarks %></span>
                </div>
              </div>
              <div
                class="flex items-center gap-4 w-full md:w-auto mt-4 md:mt-0"
              >
                <a
                  href="/uploads/<%= test.questionPaper %>"
                  class="w-full md:w-auto px-6 py-2 btn-lime"
                  target="_blank"
                  download
                >
                  Download Paper
                </a>
              </div>
            </div>
            <% }) %>
          </div>
          <% } %>
        </div>
      </div>
    </div>
  </body>
</html>
