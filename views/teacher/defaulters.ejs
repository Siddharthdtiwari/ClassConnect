<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Defaulter List - <%= month %>/<%= year %></title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<%- include('../partials/background') %>

<body class="bg-purple-50 min-h-screen flex flex-col items-center py-10">
  <div class="w-full max-w-6xl px-6">
    <header class="mb-8">
      <a href="/teacher/manage_attendance" class="content-container text-purple-700 hover:underline mb-4 block">
        &larr; Back to Attendance
      </a>
      <h1 class="text-3xl md:text-4xl font-bold text-gray-900">
        Defaulter List - <%= month %>/<%= year %>
      </h1>
      <p class="text-gray-600 mt-1">
        List of students with attendance below 75% for the selected month.
      </p>
    </header>

    <% if (defaulters.length> 0) { %>
    <div class="content-container overflow-x-auto bg-white shadow-lg rounded-2xl">
      <table class="w-full text-left border-collapse">
        <thead>
          <tr class="bg-purple-600 text-white">
            <th class="px-6 py-4 text-sm font-semibold">Student Name</th>
            <th class="px-6 py-4 text-sm font-semibold">Student ID</th>
            <th class="px-6 py-4 text-sm font-semibold">Phone No</th>
            <th class="px-6 py-4 text-sm font-semibold">Present</th>
            <th class="px-6 py-4 text-sm font-semibold">Absent</th>
            <th class="px-6 py-4 text-sm font-semibold">Attendance %</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <% defaulters.forEach(d=> { const percentage = d.total > 0 ?
            ((d.present / d.total) * 100).toFixed(2) : 0; const danger =
            percentage < 50 ? "bg-red-50" : "bg-yellow-50" ; %>
          <tr class="hover:bg-brand-purple transition duration-200 <%= danger %>">
            <td class="px-6 py-4 font-medium text-gray-800">
              <%= d.studentName %>
            </td>
            <td class="px-6 py-4 text-gray-600"><%= d.studentId %></td>
            <td class="px-6 py-4 text-gray-600"><%= d.mobileNo %></td>
            <td class="px-6 py-4 text-green-700 font-semibold">
              <%= d.present %>
            </td>
            <td class="px-6 py-4 text-red-700 font-semibold">
              <%= d.absent %>
            </td>
            <td class="px-6 py-4 font-bold <%= percentage < 50 ? 'text-red-600' : 'text-yellow-600' %>">
              <%= percentage %>%
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
    <% } else { %>
    <div class="bg-brand-purple text-purple-800 px-6 py-4 rounded-xl shadow-md text-center font-semibold">
      ðŸŽ‰ No defaulters this month!
    </div>
    <% } %>
  </div>
</body>

</html>